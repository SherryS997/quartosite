<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-11-26">

<title>Neeldhara - Stable Matchings</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="../../../css/styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Neeldhara</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Research</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="../../../research/overview.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../research/people.html">
 <span class="dropdown-text">People</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../research/publications.html">
 <span class="dropdown-text">Publications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../research/surveys">
 <span class="dropdown-text">Surveys</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Teaching</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teaching">    
        <li>
    <a class="dropdown-item" href="../../../courses/index.html">
 <span class="dropdown-text">Courses</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../materials/index.html">
 <span class="dropdown-text">Materials</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lists" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lists</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lists">    
        <li>
    <a class="dropdown-item" href="../../../tgif/">
 <span class="dropdown-text">Puzzles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../bookmarks/">
 <span class="dropdown-text">Bookmarks</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-exposition" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Exposition</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-exposition">    
        <li>
    <a class="dropdown-item" href="../../../talks/">
 <span class="dropdown-text">Talks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../videos/">
 <span class="dropdown-text">Videos</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../events/">
 <span class="menu-text">Events</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/c/NeeldharaMisra42"><i class="bi bi-youtube" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/neeldhara-misra-a54b6920/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/neeldhara"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://mathstodon.xyz/@neeldhara"><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Stable Matchings</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../materials/dsanotes/index.html" class="sidebar-item-text sidebar-link">Data Structures and Algorithms</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../materials/dsanotes/introduction/index.html" class="sidebar-item-text sidebar-link">Data Structures and Structured Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../materials/dsanotes/stable-matchings/index.html" class="sidebar-item-text sidebar-link active">Stable Matchings</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../materials/dsanotes/sequences/index.html" class="sidebar-item-text sidebar-link">Representing Sequences</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../materials/dsanotes/graphs/index.html" class="sidebar-item-text sidebar-link">Representing Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../materials/dsanotes/debruijn/index.html" class="sidebar-item-text sidebar-link">On Cards and Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../materials/dsanotes/eulertours/index.html" class="sidebar-item-text sidebar-link">Walking Around via Euler Tours</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../materials/dsanotes/dfs/index.html" class="sidebar-item-text sidebar-link">Navigating Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../materials/dsanotes/23-trees/index.html" class="sidebar-item-text sidebar-link">Balanced BSTs</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#references" id="toc-references" class="nav-link active" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Stable Matchings</h1>
  <div class="quarto-categories">
    <div class="quarto-category">dsanotes</div>
    <div class="quarto-category">lecturenotes</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 26, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>The problem of pairing up people and/or resources shows up a lot:</p>
<ul>
<li>Matching students who graduate high school to seats in various colleges.</li>
<li>Matching students who graduate college to employers for jobs, internships, residencies, and so on.</li>
<li>Getting actors and actresses to commit to work together for films amidst various constraints.</li>
<li>Matching organ donors to patients accounting for constraints of compatibility and timing.</li>
<li>Matching men and women in a dating/marriage market.</li>
</ul>
<p>We are going to look at one particular abstraction that captures many of the scenarios above (among others). Suppose we have a set <span class="math inline">V = \{m_1, \ldots, m_n\}</span> of <span class="math inline">n</span> men and <span class="math inline">W = \{w_1, \ldots, w_n\}</span> of <span class="math inline">n</span> women, where each man (respectively, woman) has a strict and complete ranking over the women (respectively, men). Our goal is to find a <em>matching</em> between the men and the women, which is to say, a bijection between <span class="math inline">V</span> and <span class="math inline">W</span>.</p>
<p>Now, a natural question at this point is: what kind of matchings do we want to find? Unconstrained, there are plenty of matchings that we can choose from. Which one is the “best”?</p>
<p>Upon a moment’s reflection you might come up with several ideas. We are going to focus on a fundamental game-theoretic approach to identifying what we desire from the matchings we seek. What we will demand of the matching <span class="math inline">M</span> that we seek is that there <em>is no man and woman who are unmatched in <span class="math inline">M</span> who prefer each other over their matched partners</em>. To this end, we first define the notion of a blocking pair with respect to <span class="math inline">M</span>:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Blocking Pair
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given a matching <span class="math inline">M</span> between <span class="math inline">n</span> men and <span class="math inline">n</span> women, if <span class="math inline">a \in V</span> and <span class="math inline">b \in W</span>, then <span class="math inline">(a,b)</span> forms a <em>blocking pair</em> if ALL of the following hold:</p>
<ul>
<li><span class="math inline">a</span> and <span class="math inline">b</span> are <em>not</em> matched to each other in <span class="math inline">M</span>,</li>
<li><span class="math inline">a</span> prefers <span class="math inline">b</span> over <span class="math inline">M(a)</span>,</li>
<li><span class="math inline">b</span> prefers <span class="math inline">a</span> over <span class="math inline">M(b)</span></li>
</ul>
</div>
</div>
<p>The presence of a blocking pair <span class="math inline">(a,b)</span> implies that the matching <span class="math inline">M</span> is unlikely to “sustain”: <span class="math inline">a</span> and <span class="math inline">b</span> <em>both</em> have an incentive to break off the alliances suggested by the matching <span class="math inline">M</span> and “elope” with each other instead. Thus, matchings that have blocking pairs are called <strong>unstable</strong>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Unstable Matching
</div>
</div>
<div class="callout-body-container callout-body">
<p>A matching <span class="math inline">M</span> is said to be <em>unstable</em> if there is a blocking pair with respect to <span class="math inline">M</span>.</p>
</div>
</div>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
An Example of a Matching with <em>no</em> blocking pairs.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Consider the preferences given below (where the first column in each row is the ID of the men and the women, and the remaining columns indicate the rank):</p>
<table class="table">
<thead>
<tr class="header">
<th>Men</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>4</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>1</td>
<td>4</td>
<td>2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
<td>1</td>
<td>3</td>
<td>2</td>
</tr>
</tbody>
</table>
<table class="table">
<thead>
<tr class="header">
<th>Women</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>1</td>
<td>4</td>
<td>3</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>3</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>4</td>
<td>3</td>
<td>2</td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
<td>1</td>
<td>4</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>and the matching given by: <strong>M = (1,4), (2,3), (3,2), (4,1)</strong>. Notice that this matching has, in fact, <em>no</em> blocking pairs.</p>
</div>
</div>
</div>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
How many blocking pairs can we have?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Come up with a stable matching instance that has <span class="math inline">\Omega(n^2)</span> blocking pairs. What’s the maximum number possible?</p>
</div>
</div>
<p>A matching without blocking pairs is called <strong>stable</strong>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Stable Matching
</div>
</div>
<div class="callout-body-container callout-body">
<p>A matching <span class="math inline">M</span> is said to be <em>stable</em> if there are no blocking pairs with respect to <span class="math inline">M</span>.</p>
</div>
</div>
<p>It’s easy to verify if a <em>given</em> matching <span class="math inline">M</span> is stable: for all men <span class="math inline">m</span> we look up all women <span class="math inline">w</span> that <span class="math inline">m</span> ranks higher than <span class="math inline">M(m)</span>, and check if <span class="math inline">w</span> also ranks <span class="math inline">m</span> higher than <span class="math inline">M(w)</span>: if yes, then we can declare <span class="math inline">M</span> unstable since <span class="math inline">(m,w)</span> is a blocking pair. If we find no blocking pairs after having checked all men <span class="math inline">m</span>, then we can declare that <span class="math inline">M</span> is stable.</p>
<p>This takes at most <span class="math inline">O(n^2)</span> time, assuming that ranks can be retrieved in constant time. Thus we have the following.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Verifying that a matching is stable.
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given a matching <span class="math inline">M</span> between <span class="math inline">n</span> men and <span class="math inline">n</span> women and their preferences over each other, it is possible to verify if <span class="math inline">M</span> is stable in <span class="math inline">O(n^2)</span> time.</p>
</div>
</div>
<p>The next natural questions are:</p>
<ul>
<li>Do stable matchings always exist?
<ul>
<li>If yes: can we always find them efficiently?</li>
<li>If not: can we efficiently find matchings that minimize the number of blocking pairs?</li>
</ul></li>
</ul>
<p>It turns out that (somewhat surprisingly!) stable matchings indeed always exist!</p>
<p>The algorithm for finding a stable matching works as follows. To begin with, we say that all men and women are <em>single</em>, i.e, unmatched to anyone so far.</p>
<p>Anticipating our need for stability, we take a greedy approach: the men attempt to match up to their best option by <em>proposing</em> to them. But notice that this may not be immediately workable: possibly multiple men have the same choice for their top option. This puts the ball in the woman’s court, so to speak, and again in the interest of being eventually stable, it’s intuitive that the woman will choose to align with the best offer she has among the proposals she’s recieved.</p>
<p>Also, since we finally want everyone to be matched, we will also ensure that proposals are not rejected simply because they seem unattractive in absolute terms: if a woman who’s single recieves one or more proposals, she will accept the best among them, no matter how good or bad they are.</p>
<p>After one round of proposals, the situation is as follows:</p>
<ul>
<li>some women (say <span class="math inline">W_\star \subseteq W</span>) recieved one or more proposals and picked the best offer, and are no longer single;</li>
<li>some women (say <span class="math inline">W_0 = W \setminus W_\star</span>) recieved no proposals and are still single;</li>
<li>some men (say <span class="math inline">V_\star \subseteq V</span>) had their proposals accepted and they are no longer single ;</li>
<li>some men (say <span class="math inline">V_0 = V \setminus V_\star</span>) were turned down and are still single.</li>
</ul>
<p>If <span class="math inline">W_0 = \emptyset</span>, that’s… well, that’s awesome, because what that means is all men had distinct choices for their top preference, and so <span class="math inline">V_0 = \emptyset</span> as well and we already have a matching where everyone has their best possible match: so this is clearly very stable and we are done.</p>
<p>On the other hand, it’s possible that <span class="math inline">W_0 \neq \emptyset</span>, which is to say that some women are still single, and therefore there are some single men as well. Now, to make progress, single men go back to the drawing board and propose <em>again</em>. Now, a natural question at this point is the following:</p>
<blockquote class="blockquote">
<p>Should the currently single men try their luck again with women who’ve rejected them?</p>
</blockquote>
<p>Well, since they were rejected for good reason (said women had better offers), and the reason has not gone away, it is clearly a waste of time for men to go back to women who’ve rejected them. So what they do instead is to propose to the <em>next best option</em>. Now: what if their next best option is <em>not</em> a single woman? Well, suppose <span class="math inline">m</span> decides to not approach <span class="math inline">w</span> because <span class="math inline">w</span> is matched to some <span class="math inline">m^\star</span> in the first round. Then <span class="math inline">m</span> will eventually be matched to someone who’s worse than <span class="math inline">w</span>, and <em>if</em> <span class="math inline">w</span> happened to prefer <span class="math inline">m</span> over <span class="math inline">m^\star</span>, then <span class="math inline">(m,w)</span> will eventually be a blocking pair.</p>
<p>However, recall that this is exactly the situation we want to avoid. So we’re going to have <span class="math inline">m</span> propose to their next best option <em>irrespective</em> of whether they are single or not. From the woman’s perspective, they are going to recieve proposals again, and we’ll let them pick the best offer, <em>even if it means breaking off their current engagement</em>.</p>
<p>After this second round of proposals we again have some single men and women, and some engagements. Note that the following invariant is true:</p>
<blockquote class="blockquote">
<p>Any woman who was not single at the end of the first round remains engaged at the end of the second round as well.</p>
</blockquote>
<p>Men, on the other hand, may become single again. At this point, we simply continue as before: at the end of every round, the single men continue to propose to their current best option, and the women continue to accept the best offer that they have. We continue this until there are no</p>
<p>Here’s pseudocode (borrowed from Wikipedia) summarizing the algorithm, which is due to Gale and Shapley. The version below is morally equivalent to our description above, except that all proposals happen one by one, and it turns out that this way of looking at it simplifies the analysis.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode pascal code-with-copy"><code class="sourceCode pascal"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>algorithm stable_matching <span class="kw">is</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    Initialize m ∈ M <span class="kw">and</span> w ∈ W <span class="kw">to</span> free</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">while</span> ∃ free man m who has a woman w <span class="kw">to</span> propose <span class="kw">to</span> <span class="kw">do</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        w&nbsp;:= first woman <span class="kw">on</span> m<span class="st">'s list to whom m has not yet proposed</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> ∃ some pair (m<span class="st">', w) then</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> w prefers m <span class="kw">to</span> m<span class="st">' then</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                m<span class="st">' becomes free</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                (m, w) become engaged</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>            <span class="kw">end</span> <span class="kw">if</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">else</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>            (m, w) become engaged</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">end</span> <span class="kw">if</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">repeat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It turns out that this procedure:</p>
<ul>
<li>terminates in finite time (in fact, after <span class="math inline">O(n^2)</span> proposals have been made)</li>
<li>outputs a perfect matching <span class="math inline">M</span> between the men and the women that has <strong>no blocking pairs</strong>.</li>
</ul>
<p>The first property follows from the fact that men never propose twice to the same woman, so the number of proposals made is <span class="math inline">\leqslant n^2</span> . Also note that no man <span class="math inline">m</span> is rejected by <em>all</em> women: this can only happen if all the women have found better engagements (which are necessarily distinct — notice that the set of engagments at any stage of the algorithm always forms a valid matching), but there are only <span class="math inline">n-1</span> men other than <span class="math inline">w</span>: so this is not feasible.</p>
<p>So we know that the <code>while</code> loop terminates, and that once it does we have a matching <span class="math inline">M</span>.</p>
<p>It remains to show that <span class="math inline">M</span> is stable. But if <span class="math inline">M</span> has a blocking pair <span class="math inline">(m,w)</span>, then <span class="math inline">w</span> was proposed to by <span class="math inline">m</span> before <span class="math inline">m</span> proposed to <span class="math inline">M(w)</span>, and since <span class="math inline">(m,w)</span> are not matched in <span class="math inline">M</span>, it must be the case that <span class="math inline">w</span> prefers <span class="math inline">M(w)</span> over <span class="math inline">m</span>, so <span class="math inline">(m,w)</span> cannot be a blocking pair after all.</p>
<p>This brings us to the following claim:</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Finding a stable matching
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given a matching <span class="math inline">M</span> between <span class="math inline">n</span> men and <span class="math inline">n</span> women and their preferences over each other, it is possible to find a stable matching <span class="math inline">M</span> in <span class="math inline">O(n^3)</span> time.</p>
</div>
</div>
<p>The output of the Gale-Shapley algorithm has a couple of interesting properties. First off, it turns out that the output is not just stable, but also qualitatively very good. Let us define, for a man <span class="math inline">m</span>, their optimal match as the best woman that <span class="math inline">m</span> can be matched to in any stable matching. It turns out that <span class="math inline">M</span> matches all men to their optimal matches!</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
The Men Are Lucky
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">M</span> be the output of the GS algorithm. For all men <span class="math inline">m</span>, there is no stable matching <span class="math inline">M^\star</span> where <span class="math inline">m</span> prefers <span class="math inline">M^\star(m)</span> over <span class="math inline">M(m)</span>.</p>
</div>
</div>
<p>Also, the output of GS is <em>weakly Pareto optimal</em>, which is to say that there is <em>no matching</em> (stable or otherwise), where <em>all</em> the men are better off.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
The GS matching is weakly PO
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">M</span> be the output of the GS algorithm. There is no matching <span class="math inline">M^\star</span> for which it is true that <em>all</em> men <span class="math inline">m</span> prefer <span class="math inline">M^\star(m)</span> over <span class="math inline">M(m)</span>.</p>
</div>
</div>
<p>We state these claims above without proof. The interested reader should look them up!</p>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p><a href="https://www.youtube.com/watch?v=Qcv1IqHWAzg">Numberphile video about the algorithm</a></p>
<p><a href="https://www.youtube.com/watch?v=LtTV6rIxhdo">Numberphile video about the proof</a></p>
<p><a href="https://cse.buffalo.edu/faculty/atri/courses/331/fall14/handouts/GS-details.pdf">Notes on implementation details</a></p>


</section>

</main> <!-- /main -->
<script type="text/javascript" src="https://sdk.userbase.com/2/userbase.js"></script>

<script src="https://cdn.usefathom.com/script.js" data-site="INVUSZCW" defer=""></script>

<script async="" src="https://tally.so/widgets/embed.js"></script>

<script type="text/javascript">
    var HYVOR_TALK_WEBSITE = 6210;
        var HYVOR_TALK_CONFIG = {
            url: false,
            id: false
        };
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://talk.hyvor.com/web-api/embed.js";
    document.body.appendChild(script);
</script>
<div id="hyvor-talk-view"></div>

<div class="column-screen-inset">
    <hr class="about-sep">
    <div class="quarto-about-jolla column-body" style="margin-top:52px;">
        <p> © 2022 • Neeldhara Misra • <a href="../../../credits.html">Credits</a> • <i data-target="calvinmodal" data-toggle="modal" class="bi bi-emoji-smile-upside-down"></i>
            </p>
            <div class="collcontent">
                <img src="../../../images/calvin.webp" style="border-radius:25px;">
                <p>&nbsp;</p>
            </div>
    
        <p> Corrections? Please leave a comment here or a PR <a href="https://github.com/neeldhara/quartosite">in this repository</a>, thanks!</p>
    

        <div class="slideshow-container">

            <div class="mySlides">
              <q>I’d rather be a failure at something I love than a success at something I hate.</q>
              <p class="author">George Burns</p>
            </div>
            
            <div class="mySlides">
              <q>You live and you learn — at any rate, you live.</q>
              <p class="author">Douglas Adams</p>
            </div>
            
            <div class="mySlides">
              <q>A problem worthy of attack proves its worth by fighting back.</q>
              <p class="author">Paul Erdos</p>
            </div>
                        
        </div>


    
        <div class="about-links">
            <a rel="me" href="https://mathstodon.xyz/@neeldhara" class="about-link">
                <i class="bi bi-mastodon"></i>
            </a>
            <a href="https://www.isibang.ac.in/~gm/" class="about-link">
                <i class="bi bi-heart-fill" style="color:red;"></i>
            </a>
            <a href="https://github.com/neeldhara" class="about-link">
                <i class="bi bi-github"></i>
            </a>
        </div> 
 </div>
</div>




<!-- The Modal -->
<div id="calvinmodal" class="modal">
    <!-- Modal content -->
    <div class="modal-content" style="width: 460px !important;">
    <span class="close" data-dismiss="modal">×</span>
    <img src="../../../images/calvin.jpg" style="border-radius:25px;" width="420">
</div>

<script type="text/javascript" src="../../../scripts.js"></script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</div><script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>